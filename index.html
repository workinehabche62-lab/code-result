<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024">
    <title>Damot 01 Secondary School Official Portal</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root { --primary: #003366; --accent: #ffcc00; --success: #2ecc71; --danger: #e74c3c; --dark: #000000; }
        body { font-family: 'Poppins', sans-serif; background: #f0f2f5; margin: 0; padding: 0; }

        .container { 
            width: 1000px; margin: 30px auto; background: white; 
            border-radius: 35px; box-shadow: 0 30px 70px rgba(0,0,0,0.2); 
            overflow: hidden; border: 1px solid #ccc; position: relative;
        }

        /* ·ä†·ã≤·à± ·ã®·ãç·àÉ ·àù·àç·ä≠·âµ ·ã≤·ãõ·ã≠·äï */
        #watermark {
            display: none;
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 130px;
            color: rgba(46, 204, 113, 0.15); /* ·ã∞·ä´·àõ ·ä†·à®·äï·åì·ã¥ */
            font-weight: 900;
            z-index: 0;
            pointer-events: none;
            white-space: nowrap;
            border: 15px solid rgba(46, 204, 113, 0.15);
            padding: 10px 40px;
            text-transform: uppercase;
            letter-spacing: 10px;
        }

        .error-msg { color: var(--danger); font-weight: 700; font-size: 15px; margin-top: 10px; display: none; }

        .lang-bar { background: #fff; padding: 15px; text-align: center; border-bottom: 1px solid #eee; }
        .lang-btn { 
            background: #f8fafc; border: 1px solid #ddd; padding: 10px 20px; 
            margin: 4px; cursor: pointer; border-radius: 12px; font-weight: 600; font-family: 'Poppins';
        }
        .lang-btn.active { background: var(--primary); color: white; }

        .school-banner { 
            background: linear-gradient(135deg, #001a33 0%, #004488 100%); 
            color: white; padding: 60px 20px; text-align: center; 
            border-bottom: 12px solid var(--accent);
        }
        .school-banner h1 { font-size: 50px; font-weight: 900; margin: 0; letter-spacing: 2px; }
        .school-banner p { font-style: italic; font-size: 18px; margin-top: 10px; color: #ffcc00; }

        .login-card, .admin-card { padding: 80px 20px; text-align: center; }
        input, textarea { width: 400px; padding: 18px; margin: 12px 0; border: 2px solid #cbd5e0; border-radius: 15px; font-size: 18px; outline: none; font-family: 'Poppins'; }
        .btn-main { background: var(--primary); color: white; padding: 20px 60px; border: none; border-radius: 15px; cursor: pointer; font-weight: 800; font-size: 18px; text-transform: uppercase; transition: 0.3s; }
        .btn-main:hover { opacity: 0.9; transform: translateY(-2px); }
        .btn-danger { background: var(--danger); color: white; padding: 15px 40px; border: none; border-radius: 15px; cursor: pointer; font-weight: 800; text-transform: uppercase; margin-top: 10px; }

        #resultArea, #adminArea { display: none; padding: 40px; position: relative; z-index: 1; }
        
        .stats-ribbon { display: flex; gap: 20px; margin-bottom: 30px; }
        .stats-box { background: var(--primary); color: white; padding: 20px; border-radius: 20px; flex: 1; text-align: center; }
        .stats-box b { font-size: 35px; color: var(--accent); display: block; }

        .student-list-container { max-height: 250px; overflow-y: auto; border: 1px solid #eee; border-radius: 15px; padding: 15px; background: #f9f9f9; text-align: left; margin-bottom: 20px; }
        .student-item { padding: 8px 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; font-size: 14px; }

        #pName { font-size: 40px; font-weight: 900; color: var(--dark); text-align: center; margin: 0; text-transform: uppercase; }
        .report-label { display: block; text-align: center; font-weight: 800; color: var(--primary); font-size: 18px; letter-spacing: 3px; margin-bottom: 30px; }

        .grid-info { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 30px; }
        .info-cell { background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #cbd5e0; }
        .info-cell label { font-size: 12px; color: #666; font-weight: 800; display: block; text-transform: uppercase; }
        .info-cell div { font-size: 19px; font-weight: 700; color: #000; margin-top: 5px; }

        .summary-ribbon { 
            display: flex; justify-content: space-around; background: var(--primary); 
            border-radius: 20px; padding: 30px; margin-bottom: 40px; color: white;
        }
        .ribbon-item b { font-size: 45px; color: var(--accent); display: block; }

        table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }
        th { background: #edf2f7; padding: 20px; font-size: 16px; text-transform: uppercase; font-weight: 800; color: #2d3748; }
        td { padding: 16px; border-bottom: 2px solid #edf2f7; text-align: center; font-weight: 700; font-size: 22px; color: #1a202c; }
        td:first-child { text-align: left; padding-left: 20px; }

        .action-bar { text-align: center; padding-bottom: 40px; }
        .btn-pdf { background: #1a202c; color: white; padding: 20px 50px; border-radius: 15px; border: none; cursor: pointer; font-weight: 800; font-size: 18px; }
        .btn-call { background: #22c55e; color: white; padding: 20px 50px; border-radius: 15px; text-decoration: none; font-weight: 800; font-size: 18px; display: inline-block; margin-left: 15px; }
        
        .admin-link { position: absolute; bottom: 10px; right: 20px; font-size: 14px; color: #cbd5e0; text-decoration: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="container" id="printableArea">
    <div id="watermark">VERIFIED</div>

    <div class="lang-bar no-pdf">
        <button class="lang-btn active" onclick="setLanguage('am', this)">·ä†·àõ·à≠·äõ</button>
        <button class="lang-btn" onclick="setLanguage('en', this)">English</button>
        <button class="lang-btn" onclick="setLanguage('om', this)">Oromoo</button>
        <button class="lang-btn" onclick="setLanguage('so', this)">Soomaali</button>
        <button class="lang-btn" onclick="setLanguage('ti', this)">·âµ·åç·à≠·äõ</button>
    </div>

    <div class="school-banner">
        <h1 id="t_school">DAMOT 01 SECONDARY SCHOOL</h1>
        <p id="t_slogan">"Empowering Minds, Shaping Futures through Knowledge and Excellence"</p>
    </div>

    <div id="loginSection" class="login-card">
        <h2 id="t_welcome">·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°! / Welcome!</h2>
        <input type="text" id="regName" placeholder="Full Name (Exactly as registered)">
        <input type="text" id="regID" placeholder="Student ID Number">
        <input type="password" id="regPass" placeholder="Password">
        <div id="loginError" class="error-msg">‚ùå Invalid or Incorrect Credentials!</div>
        <br>
        <button class="btn-main" id="t_viewBtn" onclick="loadStudentResult()">View My Result</button>
    </div>

    <div id="adminLoginSection" class="admin-card" style="display:none;">
        <h2 style="color:var(--primary)">ADMIN OPERATOR LOGIN</h2>
        <input type="text" id="adminUser" placeholder="Admin Username">
        <input type="password" id="adminKey" placeholder="Admin Password">
        <input type="text" id="adminSchoolNum" placeholder="School Number">
        <div id="adminLoginError" class="error-msg">‚ùå Invalid Admin Credentials!</div>
        <br>
        <button class="btn-main" onclick="accessAdmin()">Login to Admin Panel</button>
    </div>

    <div id="adminArea">
        <h2 style="color:var(--primary)">STUDENT DATA MANAGEMENT</h2>
        <div class="stats-ribbon"><div class="stats-box">Total Students Loaded <b id="totalCount">0</b></div></div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <h3>Student Directory</h3>
                <div class="student-list-container" id="studentList"></div>
                <div style="background: #fff5f5; padding: 20px; border-radius: 20px; border: 1px solid #ffcccc;">
                    <h4 style="color: var(--danger); margin:0 0 10px 0;">Delete Student</h4>
                    <input type="text" id="deleteID" placeholder="Enter Student ID" style="width: 100%; box-sizing: border-box;">
                    <button class="btn-danger" style="width:100%" onclick="deleteStudent()">Confirm Delete</button>
                </div>
            </div>
            <div>
                <h3>Upload Options</h3>
                <div style="background: #f0f9ff; padding: 15px; border-radius: 15px; border: 1px solid #bae6fd; margin-bottom: 15px;">
                    <p style="margin:0 0 10px 0; font-weight:bold;">1. Upload JSON from Folder:</p>
                    <input type="file" id="fileInput" accept=".json" style="width: 100%; border: none; padding: 5px;">
                    <button class="btn-main" style="padding: 10px; width: 100%; margin-top: 10px; font-size: 14px;" onclick="handleFileUpload()">Process Folder Upload</button>
                </div>
                <p style="font-weight:bold;">2. Manual JSON Paste:</p>
                <textarea id="bulkData" rows="6" style="width:100%; border-color:var(--primary); box-sizing: border-box;" placeholder="Paste student JSON here..."></textarea>
                <button class="btn-main" style="width:100%; margin-top:10px;" onclick="uploadData()">Save to Database</button>
            </div>
        </div>
        <br><hr><br>
        <button class="btn-main" style="background:#64748b;" onclick="location.reload()">Log Out</button>
    </div>

    <div id="resultArea">
        <img id="pPhoto" src="" style="width:180px; height:180px; border-radius:50%; display:block; margin:0 auto 20px; border:10px solid #fff; box-shadow:0 15px 30px rgba(0,0,0,0.15);">
        <div id="pName"></div>
        <div class="report-label" id="pIDLabel">OFFICIAL STUDENT TRANSCRIPT</div>

        <div class="grid-info">
            <div class="info-cell"><label id="l_id">ID No</label><div id="pID"></div></div>
            <div class="info-cell"><label id="l_gen">Gender</label><div id="pGen"></div></div>
            <div class="info-cell"><label id="l_grade">Grade</label><div id="pGrade"></div></div>
            <div class="info-cell"><label id="l_year">Year</label><div id="pYear"></div></div>
            <div class="info-cell"><label id="l_nat">Nationality</label><div id="pNat"></div></div>
            <div class="info-cell"><label id="l_zone">Zone</label><div id="pZone"></div></div>
            <div class="info-cell"><label id="l_wor">Woreda</label><div id="pWor"></div></div>
            <div class="info-cell"><label id="l_sch">School</label><div id="pSch"></div></div>
        </div>

        <div class="summary-ribbon">
            <div class="ribbon-item"><span id="l_total">Total Score</span><b id="pTotal"></b></div>
            <div class="ribbon-item"><span id="l_avg">Average</span><b id="pAvg"></b></div>
            <div class="ribbon-item"><span id="l_status">Status</span><b id="pStatus"></b></div>
        </div>

        <table>
            <thead>
                <tr><th id="h_sub">Subject</th><th>40%</th><th>60%</th><th id="h_tot">Total</th><th id="h_grd">Grade</th></tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <div class="action-bar no-pdf">
            <button class="btn-pdf" id="t_download" onclick="downloadPDF()">Download PDF Transcript</button>
            <a href="tel:0961364574" class="btn-call">üìû <span id="t_call">Contact Registrar</span></a>
        </div>
    </div>
    
    <div class="admin-link no-pdf" onclick="showAdminLogin()">Admin Operator</div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    const translations = {
        am: { school: "·ã≥·àû·âµ 01 ·àÅ·àà·â∞·äõ ·ã∞·à®·åÉ ·âµ·àù·àÖ·à≠·âµ ·â§·âµ", slogan: "·ä•·ãç·âÄ·âµ·äï ·â†·àõ·àµ·çã·âµ ·â•·à©·àÖ ·â∞·àµ·çã·äï ·àò·åà·äï·â£·âµ", welcome: "·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°!", viewBtn: "·ãç·å§·âµ ·ã≠·àò·àç·ä®·â±", l_id: "·àò·àà·ã´ ·âÅ·å•·à≠", l_gen: "·åæ·â≥", l_grade: "·ä≠·çç·àç", l_year: "·ãò·àò·äï", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·äï", l_wor: "·ãà·à®·ã≥", l_sch: "·âµ·àù·àÖ·à≠·âµ ·â§·âµ", l_total: "·ãµ·àù·à≠", l_avg: "·ä†·àõ·ä´·ã≠", l_status: "·àÅ·äî·â≥", h_sub: "·âµ·àù·àÖ·à≠·âµ", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä†·ãç·à≠·ãµ", call: "·à¨·åÖ·àµ·âµ·à´·à≠", report: "·ä¶·çä·à¥·àã·ãä ·ã®·ãç·å§·âµ ·àò·åç·àà·å´", sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "·ä†·ã≠·à≤·â≤", "·ä§·âΩ·çí", "·ä†·àõ·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] },
        en: { school: "DAMOT 01 SECONDARY SCHOOL", slogan: "Empowering Minds, Shaping Futures", welcome: "Welcome!", viewBtn: "View Result", l_id: "ID", l_gen: "Gender", l_grade: "Grade", l_year: "Year", l_nat: "Nationality", l_zone: "Zone", l_wor: "Woreda", l_sch: "School", l_total: "Total", l_avg: "Average", l_status: "Status", h_sub: "Subject", h_tot: "Total", h_grd: "Grade", download: "Download PDF", call: "Support", report: "OFFICIAL TRANSCRIPT", sNames: ["Maths", "English", "Chemistry", "Physics", "Biology", "Geography", "History", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        om: { school: "MANA BARUMSA DAMOT 01", slogan: "Barnoota Qulqulluu", welcome: "Baga Nagaan Dhuftan!", viewBtn: "Bu'aa Ilaali", l_id: "ID", l_gen: "Korniyaa", l_grade: "Kutaa", l_year: "Bara", l_nat: "Lammummaa", l_zone: "Zoonii", l_wor: "Aanaa", l_sch: "Mana Barumsaa", l_total: "Ida'ama", l_avg: "Average", l_status: "Haala", h_sub: "Barnoota", h_tot: "Total", h_grd: "Gireedii", download: "PDF Buusi", call: "Koomii", report: "GABAASA BU'AA", sNames: ["Maatiiksii", "Ingiliffa", "Keemistirii", "Fiiziksii", "Baayoloojii", "Ji'oogiraafii", "Seenaa", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        so: { school: "DUGSIYADA DAMOT 01", slogan: "Waxbarasho tayo leh", welcome: "Ku soo dhawaada!", viewBtn: "Arag Natiijada", l_id: "ID", l_gen: "Lab/Dhadig", l_grade: "Fasalka", l_year: "Sannadka", l_nat: "Dhalashada", l_zone: "Aagga", l_wor: "Degmada", l_sch: "Dugsiga", l_total: "Warta", l_avg: "Average", l_status: "Xaaladda", h_sub: "Maadada", h_tot: "Total", h_grd: "Darajada", download: "PDF", call: "Cabashada", report: "NATIIJADA", sNames: ["Xisaab", "Ingiriisi", "Kimisteri", "Fiisigis", "Bayoolaji", "Juqraafi", "Taariikh", "ICT", "HP", "Amxaari", "Muwaadin", "Dhaqaalaha"] },
        ti: { school: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤ ·â§·âµ ·ã≥·àû·âµ 01", slogan: "·çÖ·à¨·âµ ·ãò·àà·ãé ·âµ·àù·àÖ·à≠·â≤", welcome: "·ä•·äï·ä≥·ãï ·â•·ã∞·àì·äï ·àò·åª·ä•·ä©·àù!", viewBtn: "·ãç·åΩ·ä¢·âµ ·à≠·ä†", l_id: "·àò·çç·àà·ã™", l_gen: "·çÜ·â≥", l_grade: "·ä≠·çç·àä", l_year: "·ãì·àò·âµ", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·â£", l_wor: "·ãà·à®·ã≥", l_sch: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤", l_total: "·å†·âï·àã·àã", l_avg: "Average", l_status: "·ä©·äê·â≥·âµ", h_sub: "·âµ·àù·àÖ·à≠·â≤", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä£·ãç·à≠·ãµ", call: "·âÖ·à¨·â≥", report: "·àò·åç·àà·çÇ ·ãç·çÖ·ä¢·âµ", sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "ICT", "HP", "·ä£·àù·àì·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] }
    };

    let activeLang = 'am';
    let studentData = null;

    const firebaseConfig = {
      apiKey: "AIzaSyDqX185jJuZU5SGEjVVNCGNh5aS0hgov58",
      databaseURL: "https://damoto-school-result-default-rtdb.firebaseio.com",
      projectId: "damoto-school-result"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function setLanguage(lang, btn) {
        activeLang = lang;
        const t = translations[lang];
        document.getElementById('t_school').innerText = t.school;
        document.getElementById('t_slogan').innerText = t.slogan;
        document.getElementById('t_welcome').innerText = t.welcome;
        document.getElementById('t_viewBtn').innerText = t.viewBtn;
        document.getElementById('l_id').innerText = t.l_id;
        document.getElementById('l_gen').innerText = t.l_gen;
        document.getElementById('l_grade').innerText = t.l_grade;
        document.getElementById('l_year').innerText = t.l_year;
        document.getElementById('l_nat').innerText = t.l_nat;
        document.getElementById('l_zone').innerText = t.l_zone;
        document.getElementById('l_wor').innerText = t.l_wor;
        document.getElementById('l_sch').innerText = t.l_sch;
        document.getElementById('l_total').innerText = t.l_total;
        document.getElementById('l_avg').innerText = t.l_avg;
        document.getElementById('l_status').innerText = t.l_status;
        document.getElementById('h_sub').innerText = t.h_sub;
        document.getElementById('h_tot').innerText = t.h_tot;
        document.getElementById('h_grd').innerText = t.h_grd;
        document.getElementById('t_download').innerText = t.download;
        document.getElementById('t_call').innerText = t.call;
        document.getElementById('pIDLabel').innerText = t.report;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        if(studentData) renderTable();
    }

    function loadStudentResult() {
        const nameIn = document.getElementById('regName').value.trim();
        const idIn = document.getElementById('regID').value.trim();
        const passIn = document.getElementById('regPass').value.trim();
        const err = document.getElementById('loginError');
        err.style.display = 'none';

        db.ref('students/' + idIn).once('value').then(snap => {
            const d = snap.val();
            if(d && d.password == passIn && d.name.toLowerCase() === nameIn.toLowerCase()) {
                studentData = d;
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('resultArea').style.display = 'block';
                document.getElementById('pPhoto').src = d.photoURL || "https://via.placeholder.com/180";
                document.getElementById('pName').innerText = d.name;
                document.getElementById('pID').innerText = idIn;
                document.getElementById('pGen').innerText = d.gender;
                document.getElementById('pGrade').innerText = d.grade;
                document.getElementById('pYear').innerText = d.academicYear || "2018 E.C";
                document.getElementById('pNat').innerText = d.nationality || "Ethiopian";
                document.getElementById('pZone').innerText = d.zone || "East Gojjam";
                document.getElementById('pWor').innerText = d.woreda || "Hulet Eju Enese";
                document.getElementById('pSch').innerText = "Damot 01 Secondary School";
                document.getElementById('pTotal').innerText = d.total;
                document.getElementById('pAvg').innerText = d.average + "%";
                document.getElementById('pStatus').innerText = d.status;
                renderTable();
            } else { err.style.display = 'block'; }
        });
    }

    function renderTable() {
        const d = studentData;
        const sNames = translations[activeLang].sNames;
        const subList = [
            {n: sNames[0], t: d.maths, s4: d.maths40, s6: d.maths60}, {n: sNames[1], t: d.english, s4: d.english40, s6: d.english60},
            {n: sNames[2], t: d.chemistry, s4: d.chemistry40, s6: d.chemistry60}, {n: sNames[3], t: d.physics, s4: d.physics40, s6: d.physics60},
            {n: sNames[4], t: d.biology, s4: d.biology40, s6: d.biology60}, {n: sNames[5], t: d.geography, s4: d.geography40, s6: d.geography60},
            {n: sNames[6], t: d.history, s4: d.history40, s6: d.history60}, {n: sNames[7], t: d.ict, s4: d.ict40, s6: d.ict60},
            {n: sNames[8], t: d.hp, s4: d.hp40, s6: d.hp60}, {n: sNames[9], t: d.amharic, s4: d.amharic40, s6: d.amharic60},
            {n: sNames[10], t: d.citizenship, s4: d.citizenship40, s6: d.citizenship60}, {n: sNames[11], t: d.economics, s4: d.economics40, s6: d.economics60}
        ];
        let h = "";
        subList.forEach(s => {
            let g = s.t >= 90 ? "A+" : s.t >= 80 ? "A" : s.t >= 70 ? "B" : s.t >= 50 ? "C" : "D";
            h += `<tr><td>${s.n}</td><td>${s.s4||0}</td><td>${s.s6||0}</td><td><b>${s.t||0}</b></td><td><b>${g}</b></td></tr>`;
        });
        document.getElementById('tableBody').innerHTML = h;
    }

    // PDF Download function - Updated for Watermark
    function downloadPDF() {
        const element = document.getElementById('printableArea');
        const watermark = document.getElementById('watermark');
        
        // ·ãç·àÉ ·àù·àç·ä≠·â±·äï ·àà·çí·ã≤·ä§·çâ ·â•·âª ·ä†·à≥·ã≠
        watermark.style.display = 'block';
        document.querySelectorAll('.no-pdf').forEach(el => el.style.display = 'none');

        const opt = {
            margin: [0.1, 0, 0.1, 0],
            filename: 'Damot01_Official_Transcript.pdf',
            image: { type: 'jpeg', quality: 1 },
            html2canvas: { scale: 2, useCORS: true, logging: false, width: 1000 },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
        };

        html2pdf().from(element).set(opt).save().then(() => {
            // ·ä®·ãà·à®·ã∞ ·â†·äã·àã ·àò·àç·à∞·àÖ ·ã∞·â•·âÉ·â∏·ãç
            watermark.style.display = 'none';
            document.querySelectorAll('.no-pdf').forEach(el => el.style.display = 'block');
        });
    }

    function showAdminLogin() {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('adminLoginSection').style.display = 'block';
    }

    function accessAdmin() {
        const u = document.getElementById('adminUser').value;
        const p = document.getElementById('adminKey').value;
        const s = document.getElementById('adminSchoolNum').value;
        const err = document.getElementById('adminLoginError');
        err.style.display = 'none';
        if(u === "damot school" && p === "damot1q2w3e4@" && s === "156111001") {
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('adminArea').style.display = 'block';
            fetchAdminStats();
        } else { err.style.display = 'block'; }
    }

    function fetchAdminStats() {
        db.ref('students').on('value', snap => {
            const data = snap.val() || {};
            const keys = Object.keys(data);
            document.getElementById('totalCount').innerText = keys.length;
            let listH = "";
            keys.forEach(k => { listH += `<div class="student-item"><span>${data[k].name}</span> <b>ID: ${k}</b></div>`; });
            document.getElementById('studentList').innerHTML = listH;
        });
    }

    function handleFileUpload() {
        const file = document.getElementById('fileInput').files[0];
        if (!file) { alert("Please select a file!"); return; }
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const json = JSON.parse(e.target.result);
                db.ref('students').update(json).then(() => { alert("Database updated!"); document.getElementById('fileInput').value = ""; });
            } catch(err) { alert("Invalid JSON!"); }
        };
        reader.readAsText(file);
    }

    function uploadData() {
        try {
            const data = JSON.parse(document.getElementById('bulkData').value);
            db.ref('students').update(data).then(() => { alert("Saved!"); document.getElementById('bulkData').value = ""; });
        } catch(e) { alert("Invalid JSON!"); }
    }

    function deleteStudent() {
        const id = document.getElementById('deleteID').value.trim();
        if(!id) return;
        if(confirm("Delete ID: " + id + "?")) {
            db.ref('students/' + id).remove().then(() => { alert("Removed!"); document.getElementById('deleteID').value = ""; });
        }
    }
</script>
</body>
</html>
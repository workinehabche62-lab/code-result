<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024"> <title>Damot 01 Secondary School Result Portal</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root { 
            --primary: #003366; --accent: #ffcc00; --success: #2ecc71; 
            --dark: #000000; --bg: #f4f7f9; 
        }
        
        body { 
            font-family: 'Poppins', sans-serif; background: var(--bg); 
            margin: 0; padding: 0; min-height: 100vh; color: #333;
        }

        /* Fixed PC-Style Width */
        .container { 
            width: 980px; margin: 30px auto; background: white; 
            border-radius: 30px; box-shadow: 0 25px 60px rgba(0,0,0,0.15); 
            overflow: hidden; border: 1px solid #ddd;
        }

        .lang-bar { background: #ffffff; padding: 15px; text-align: center; border-bottom: 1px solid #eee; }
        .lang-btn { 
            background: #f8fafc; border: 1px solid #ddd; padding: 10px 20px; 
            margin: 4px; cursor: pointer; border-radius: 12px; font-weight: 600;
            transition: 0.3s; font-family: 'Poppins';
        }
        .lang-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        .school-banner { 
            background: linear-gradient(135deg, #002244 0%, #0055aa 100%); 
            color: white; padding: 60px 20px; text-align: center; 
            border-bottom: 12px solid var(--accent);
        }
        .school-banner h1 { font-size: 42px; font-weight: 900; margin: 0; letter-spacing: 1px; }

        .login-card { padding: 80px 20px; text-align: center; }
        input { 
            width: 380px; padding: 18px; margin: 12px 0; border: 2px solid #e2e8f0; 
            border-radius: 15px; font-size: 16px; font-family: 'Poppins'; outline: none;
        }

        .btn-main { 
            background: var(--primary); color: white; padding: 18px 60px; 
            border: none; border-radius: 15px; cursor: pointer; font-weight: 800; 
            font-size: 17px; margin-top: 25px; transition: 0.3s;
        }

        #resultArea { display: none; padding: 50px; }
        
        .profile-header { text-align: center; margin-bottom: 45px; }
        .student-photo { 
            width: 170px; height: 170px; border-radius: 50%; border: 6px solid white; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); margin: 0 auto 20px; display: block; object-fit: cover;
        }

        /* ·ã®·â∞·àõ·à™ ·àµ·àù ·â†·å•·âÅ·à≠ ·âÄ·àà·àù ·ä•·äì ·â†·âµ·àç·âÖ ·çé·äï·âµ */
        #pName { 
            font-size: 45px; font-weight: 900; color: var(--dark); 
            margin: 10px 0; letter-spacing: -1px; 
        }

        .report-label { 
            font-size: 14px; font-weight: 800; color: var(--primary); 
            text-transform: uppercase; background: #eef2f7; padding: 6px 22px; border-radius: 50px;
        }

        .grid-info { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 40px 0; }
        .info-cell { background: #f8fafc; padding: 15px; border-radius: 15px; border: 1px solid #edf2f7; }
        .info-cell label { font-size: 10px; color: #888; font-weight: 800; text-transform: uppercase; }
        .info-cell div { font-size: 15px; font-weight: 700; color: #1e293b; margin-top: 5px; }

        .summary-ribbon { 
            display: flex; justify-content: space-around; background: var(--primary); 
            border-radius: 20px; padding: 30px; margin-bottom: 40px; color: white;
        }
        .ribbon-item b { font-size: 35px; color: var(--accent); display: block; }

        /* Passed Status in Green */
        #pStatus { color: #2ecc71 !important; }

        .chart-container { background: white; padding: 25px; border-radius: 20px; border: 1px solid #eee; margin-bottom: 40px; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        th { background: #f1f5f9; padding: 20px; font-size: 12px; text-transform: uppercase; font-weight: 800; color: #444; }
        td { padding: 15px; border-bottom: 1px solid #f1f5f9; text-align: center; font-weight: 600; font-size: 16px; }

        .btn-pdf { background: #111; color: white; padding: 18px 45px; border-radius: 15px; border: none; cursor: pointer; font-weight: 700; }
        .btn-call { background: #25d366; color: white; padding: 18px 45px; border-radius: 15px; text-decoration: none; font-weight: 700; display: inline-block; }
    </style>
</head>
<body>

<div class="container" id="printableArea">
    <div class="lang-bar">
        <button class="lang-btn active" onclick="setLanguage('am', this)">·ä†·àõ·à≠·äõ</button>
        <button class="lang-btn" onclick="setLanguage('en', this)">English</button>
        <button class="lang-btn" onclick="setLanguage('om', this)">Oromoo</button>
        <button class="lang-btn" onclick="setLanguage('so', this)">Soomaali</button>
        <button class="lang-btn" onclick="setLanguage('ti', this)">·âµ·åç·à≠·äõ</button>
    </div>

    <div class="school-banner">
        <h1 id="t_school">DAMOT 01 SECONDARY SCHOOL</h1>
        <p id="t_slogan">Excellence Through Hard Work & Discipline</p>
    </div>

    <div id="loginSection" class="login-card">
        <h2 id="t_welcome">·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°!</h2>
        <input type="text" id="regName" placeholder="Full Name">
        <br>
        <input type="text" id="regID" placeholder="ID Number">
        <br>
        <input type="password" id="regPass" placeholder="Password">
        <br>
        <button class="btn-main" id="t_viewBtn" onclick="loadStudentResult()">View Result</button>
    </div>

    <div id="resultArea">
        <div class="profile-header">
            <img id="pPhoto" src="" class="student-photo">
            <div id="pName"></div>
            <div class="report-label" id="pIDLabel">OFFICIAL REPORT CARD</div>
        </div>
        
        <div class="grid-info">
            <div class="info-cell"><label id="l_id">ID No</label><div id="pID"></div></div>
            <div class="info-cell"><label id="l_gen">Gender</label><div id="pGen"></div></div>
            <div class="info-cell"><label id="l_grade">Grade</label><div id="pGrade"></div></div>
            <div class="info-cell"><label id="l_year">Year</label><div id="pYear"></div></div>
            <div class="info-cell"><label id="l_nat">Nationality</label><div id="pNat"></div></div>
            <div class="info-cell"><label id="l_zone">Zone</label><div id="pZone"></div></div>
            <div class="info-cell"><label id="l_wor">Woreda</label><div id="pWor"></div></div>
            <div class="info-cell"><label id="l_sch">School</label><div id="pSch"></div></div>
        </div>

        <div class="summary-ribbon">
            <div class="ribbon-item"><span id="l_total">Total</span><b id="pTotal"></b></div>
            <div class="ribbon-item"><span id="l_avg">Average</span><b id="pAvg"></b></div>
            <div class="ribbon-item"><span id="l_status">Status</span><b id="pStatus"></b></div>
        </div>

        <div class="chart-container">
            <canvas id="performanceChart" height="100"></canvas>
        </div>

        <table>
            <thead>
                <tr><th id="h_sub">Subject</th><th>40%</th><th>60%</th><th id="h_tot">Total</th><th id="h_grd">Grade</th></tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <div style="text-align:center; padding-bottom:40px;">
            <button class="btn-pdf" id="t_download" onclick="downloadPDF()">Download PDF</button>
            <a href="tel:0961364574" class="btn-call">üìû <span id="t_call">Support</span></a>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    const translations = {
        am: { school: "·ã≥·àû·âµ 01 ·àÅ·àà·â∞·äõ ·ã∞·à®·åÉ ·âµ·àù·àÖ·à≠·âµ ·â§·âµ", slogan: "·â†·âµ·åã·âµ ·ä•·äì ·â†·àµ·äê-·àù·åç·â£·à≠ ·ãà·ã∞ ·àã·âÄ ·ãç·å§·âµ", welcome: "·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°!", viewBtn: "·ãç·å§·âµ ·ã≠·àò·àç·ä®·â±", l_id: "·àò·àà·ã´ ·âÅ·å•·à≠", l_gen: "·åæ·â≥", l_grade: "·ä≠·çç·àç", l_year: "·ãò·àò·äï", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·äï", l_wor: "·ãà·à®·ã≥", l_sch: "·âµ·àù·àÖ·à≠·âµ ·â§·âµ", l_total: "·ãµ·àù·à≠", l_avg: "·ä†·àõ·ä´·ã≠", l_status: "·àÅ·äî·â≥", h_sub: "·âµ·àù·àÖ·à≠·âµ", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä†·ãç·à≠·ãµ", call: "·âÖ·à¨·â≥: 0961364574", report: "·ä¶·çä·à¥·àã·ãä ·ã®·ãç·å§·âµ ·àò·åç·àà·å´",
              sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "·ä†·ã≠·à≤·â≤", "·ä§·âΩ·çí", "·ä†·àõ·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] },
        en: { school: "DAMOT 01 SECONDARY SCHOOL", slogan: "Excellence Through Discipline", welcome: "Welcome!", viewBtn: "View Result", l_id: "ID No", l_gen: "Gender", l_grade: "Grade", l_year: "Year", l_nat: "Nationality", l_zone: "Zone", l_wor: "Woreda", l_sch: "School", l_total: "Total", l_avg: "Avg", l_status: "Status", h_sub: "Subject", h_tot: "Total", h_grd: "Grade", download: "Download PDF", call: "Support", report: "OFFICIAL REPORT CARD",
              sNames: ["Maths", "English", "Chemistry", "Physics", "Biology", "Geography", "History", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        om: { school: "MANA BARUMSA DAMOT 01", slogan: "Barnoota Qulqulluu", welcome: "Baga Nagaan Dhuftan!", viewBtn: "Bu'aa Ilaali", l_id: "ID", l_gen: "Korniyaa", l_grade: "Kutaa", l_year: "Bara", l_nat: "Lammummaa", l_zone: "Zoonii", l_wor: "Aanaa", l_sch: "Mana Barumsaa", l_total: "Ida'ama", l_avg: "Avg", l_status: "Haala", h_sub: "Barnoota", h_tot: "Total", h_grd: "Gireedii", download: "PDF Buusi", call: "Koomii", report: "GABAASA BU'AA",
              sNames: ["Maatiiksii", "Ingiliffa", "Keemistirii", "Fiiziksii", "Baayoloojii", "Ji'oogiraafii", "Seenaa", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        so: { school: "DUGSIYADA SARE EE DAMOT 01", slogan: "Waxbarasho tayo leh", welcome: "Ku soo dhawaada!", viewBtn: "Arag Natiijada", l_id: "ID", l_gen: "Lab/Dhadig", l_grade: "Fasalka", l_year: "Sannadka", l_nat: "Dhalashada", l_zone: "Aagga", l_wor: "Degmada", l_sch: "Dugsiga", l_total: "Warta", l_avg: "Avg", l_status: "Xaaladda", h_sub: "Maadada", h_tot: "Total", h_grd: "Darajada", download: "Soo deji PDF", call: "Cabashada", report: "WARBIXINTA NATIIJADA",
              sNames: ["Xisaab", "Ingiriisi", "Kimisteri", "Fiisigis", "Bayoolaji", "Juqraafi", "Taariikh", "ICT", "HP", "Amxaari", "Muwaadin", "Dhaqaalaha"] },
        ti: { school: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤ ·ã≥·àû·âµ 01", slogan: "·çÖ·à¨·âµ ·ãò·àà·ãé ·âµ·àù·àÖ·à≠·â≤", welcome: "·ä•·äï·ä≥·ãï ·â•·ã∞·àì·äï ·àò·åª·ä•·ä©·àù!", viewBtn: "·ãç·åΩ·ä¢·âµ ·à≠·ä†", l_id: "·àò·çç·àà·ã™", l_gen: "·çÜ·â≥", l_grade: "·ä≠·çç·àä", l_year: "·ãì·àò·âµ", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·â£", l_wor: "·ãà·à®·ã≥", l_sch: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤", l_total: "·å†·âï·àã·àã", l_avg: "Avg", l_status: "·ä©·äê·â≥·âµ", h_sub: "·âµ·àù·àÖ·à≠·â≤", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä£·ãç·à≠·ãµ", call: "·âÖ·à¨·â≥", report: "·àò·åç·àà·çÇ ·ãç·çÖ·ä¢·âµ",
              sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "ICT", "HP", "·ä£·àù·àì·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] }
    };

    let activeLang = 'am';
    let studentData = null;
    let myChart = null;

    const firebaseConfig = {
      apiKey: "AIzaSyDqX185jJuZU5SGEjVVNCGNh5aS0hgov58",
      databaseURL: "https://damoto-school-result-default-rtdb.firebaseio.com",
      projectId: "damoto-school-result"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function setLanguage(lang, btn) {
        activeLang = lang;
        const t = translations[lang];
        document.getElementById('t_school').innerText = t.school;
        document.getElementById('t_slogan').innerText = t.slogan;
        document.getElementById('t_welcome').innerText = t.welcome;
        document.getElementById('t_viewBtn').innerText = t.viewBtn;
        document.getElementById('l_id').innerText = t.l_id;
        document.getElementById('l_gen').innerText = t.l_gen;
        document.getElementById('l_grade').innerText = t.l_grade;
        document.getElementById('l_year').innerText = t.l_year;
        document.getElementById('l_nat').innerText = t.l_nat;
        document.getElementById('l_zone').innerText = t.l_zone;
        document.getElementById('l_wor').innerText = t.l_wor;
        document.getElementById('l_sch').innerText = t.l_sch;
        document.getElementById('l_total').innerText = t.l_total;
        document.getElementById('l_avg').innerText = t.l_avg;
        document.getElementById('l_status').innerText = t.l_status;
        document.getElementById('h_sub').innerText = t.h_sub;
        document.getElementById('h_tot').innerText = t.h_tot;
        document.getElementById('h_grd').innerText = t.h_grd;
        document.getElementById('t_download').innerText = t.download;
        document.getElementById('t_call').innerText = t.call;
        document.getElementById('pIDLabel').innerText = t.report;

        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        if(studentData) { renderTable(); updateChart(); }
    }

    function loadStudentResult() {
        const nameIn = document.getElementById('regName').value.trim();
        const idIn = document.getElementById('regID').value.trim();
        const passIn = document.getElementById('regPass').value.trim();

        db.ref('students/' + idIn).once('value').then(snap => {
            const d = snap.val();
            if(d && d.password == passIn && d.name.toLowerCase() === nameIn.toLowerCase()) {
                studentData = d;
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('resultArea').style.display = 'block';
                document.getElementById('pPhoto').src = d.photoURL || "https://via.placeholder.com/170";
                document.getElementById('pName').innerText = d.name; // Full Black Name

                document.getElementById('pID').innerText = idIn;
                document.getElementById('pGen').innerText = d.gender;
                document.getElementById('pGrade').innerText = d.grade + " (" + (d.section||'A') + ")";
                document.getElementById('pYear').innerText = d.academicYear || "2018 E.C";
                document.getElementById('pNat').innerText = d.nationality || "Ethiopian";
                document.getElementById('pZone').innerText = d.zone || "East Gojjam";
                document.getElementById('pWor').innerText = d.woreda || "Hulet Eju Enese";
                document.getElementById('pSch').innerText = d.school || "Damot 01 Secondary School";
                
                document.getElementById('pTotal').innerText = d.total;
                document.getElementById('pAvg').innerText = d.average + "%";
                document.getElementById('pStatus').innerText = d.status;

                renderTable();
                updateChart();
            } else { alert("Correct Name, ID or Password Required!"); }
        });
    }

    function renderTable() {
        const d = studentData;
        const sNames = translations[activeLang].sNames;
        const subMap = [
            {n: sNames[0], t: d.maths, s4: d.maths40, s6: d.maths60}, {n: sNames[1], t: d.english, s4: d.english40, s6: d.english60},
            {n: sNames[2], t: d.chemistry, s4: d.chemistry40, s6: d.chemistry60}, {n: sNames[3], t: d.physics, s4: d.physics40, s6: d.physics60},
            {n: sNames[4], t: d.biology, s4: d.biology40, s6: d.biology60}, {n: sNames[5], t: d.geography, s4: d.geography40, s6: d.geography60},
            {n: sNames[6], t: d.history, s4: d.history40, s6: d.history60}, {n: sNames[7], t: d.ict, s4: d.ict40, s6: d.ict60},
            {n: sNames[8], t: d.hp, s4: d.hp40, s6: d.hp60}, {n: sNames[9], t: d.amharic, s4: d.amharic40, s6: d.amharic60},
            {n: sNames[10], t: d.citizenship, s4: d.citizenship40, s6: d.citizenship60}, {n: sNames[11], t: d.economics, s4: d.economics40, s6: d.economics60}
        ];

        let html = "";
        subMap.forEach(s => {
            let g = s.t >= 90 ? "A+" : s.t >= 80 ? "A" : s.t >= 70 ? "B" : s.t >= 50 ? "C" : "D";
            html += `<tr><td>${s.n}</td><td>${s.s4||0}</td><td>${s.s6||0}</td><td><b>${s.t||0}</b></td><td><b>${g}</b></td></tr>`;
        });
        document.getElementById('tableBody').innerHTML = html;
    }

    function updateChart() {
        const d = studentData;
        const ctx = document.getElementById('performanceChart').getContext('2d');
        const sNames = translations[activeLang].sNames;
        const scores = [d.maths, d.english, d.chemistry, d.physics, d.biology, d.geography, d.history, d.ict, d.hp, d.amharic, d.citizenship, d.economics];

        if(myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: sNames,
                datasets: [{ label: 'Score', data: scores, backgroundColor: '#003366', borderRadius: 5 }]
            },
            options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, max: 100 } } }
        });
    }

    function downloadPDF() {
        const element = document.getElementById('printableArea');
        html2pdf().set({
            margin: 0, filename: 'Damot01_Result.pdf',
            html2canvas: { scale: 2, useCORS: true },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
        }).from(element).save();
    }
</script>
</body>
</html>
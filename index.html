<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024">
    <title>Damot 01 Secondary School Official Portal</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root { --primary: #003366; --accent: #ffcc00; --success: #2ecc71; --danger: #e74c3c; --dark: #000000; }
        body { font-family: 'Poppins', sans-serif; background: #f0f2f5; margin: 0; padding: 0; }

        .container { 
            width: 1000px; margin: 30px auto; background: white; 
            border-radius: 35px; box-shadow: 0 30px 70px rgba(0,0,0,0.2); 
            overflow: hidden; border: 1px solid #ccc; position: relative;
        }

        .lang-bar { background: #fff; padding: 15px; text-align: center; border-bottom: 1px solid #eee; }
        .lang-btn { 
            background: #f8fafc; border: 1px solid #ddd; padding: 8px 18px; 
            margin: 4px; cursor: pointer; border-radius: 10px; font-weight: 600; font-family: 'Poppins';
        }
        .lang-btn.active { background: var(--primary); color: white; }

        .school-banner { 
            background: linear-gradient(135deg, #001a33 0%, #004488 100%); 
            color: white; padding: 70px 20px; text-align: center; 
            border-bottom: 12px solid var(--accent);
        }
        .school-banner h1 { font-size: 45px; font-weight: 900; margin: 0; letter-spacing: 2px; }

        .login-card, .admin-card { padding: 100px 20px; text-align: center; }
        input, textarea { width: 380px; padding: 18px; margin: 12px 0; border: 2px solid #e2e8f0; border-radius: 15px; font-size: 16px; outline: none; font-family: 'Poppins'; }
        .btn-main { background: var(--primary); color: white; padding: 18px 60px; border: none; border-radius: 15px; cursor: pointer; font-weight: 800; text-transform: uppercase; }
        .btn-danger { background: var(--danger); color: white; padding: 15px 40px; border: none; border-radius: 15px; cursor: pointer; font-weight: 800; text-transform: uppercase; margin-top: 10px; }

        #resultArea, #adminArea { display: none; padding: 50px; }
        
        #pName { font-family: 'Poppins', sans-serif; font-size: 36px; font-weight: 800; color: var(--dark); text-align: center; margin: 0; text-transform: uppercase; }
        
        .report-label { display: block; text-align: center; font-weight: 800; color: var(--primary); font-size: 16px; letter-spacing: 3px; margin-bottom: 40px; }

        .grid-info { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; }
        .info-cell { background: #f8fafc; padding: 20px; border-radius: 15px; border: 1px solid #eee; }
        .info-cell label { font-size: 11px; color: #888; font-weight: 800; display: block; text-transform: uppercase; }
        .info-cell div { font-size: 17px; font-weight: 700; color: #1a202c; margin-top: 5px; }

        .summary-ribbon { 
            display: flex; justify-content: space-around; background: var(--primary); 
            border-radius: 25px; padding: 40px; margin-bottom: 50px; color: white;
        }
        .ribbon-item b { font-size: 40px; color: var(--accent); display: block; }
        #pStatus { color: var(--success) !important; }

        table { width: 100%; border-collapse: collapse; margin-bottom: 50px; }
        th { background: #f1f5f9; padding: 22px; font-size: 13px; text-transform: uppercase; font-weight: 800; }
        td { padding: 18px; border-bottom: 1px solid #f1f5f9; text-align: center; font-weight: 700; font-size: 18px; }

        .action-bar { text-align: center; padding-bottom: 60px; }
        .btn-pdf { background: #111; color: white; padding: 20px 50px; border-radius: 15px; border: none; cursor: pointer; font-weight: 700; }
        .btn-call { background: #22c55e; color: white; padding: 20px 50px; border-radius: 15px; text-decoration: none; font-weight: 700; display: inline-block; margin-left: 15px; }
        
        .admin-link { position: absolute; bottom: 10px; right: 20px; font-size: 12px; color: #ccc; text-decoration: none; cursor: pointer; }
    </style>
</head>
<body>

<div class="container" id="printableArea">
    <div class="lang-bar no-pdf">
        <button class="lang-btn active" onclick="setLanguage('am', this)">·ä†·àõ·à≠·äõ</button>
        <button class="lang-btn" onclick="setLanguage('en', this)">English</button>
        <button class="lang-btn" onclick="setLanguage('om', this)">Oromoo</button>
        <button class="lang-btn" onclick="setLanguage('so', this)">Soomaali</button>
        <button class="lang-btn" onclick="setLanguage('ti', this)">·âµ·åç·à≠·äõ</button>
    </div>

    <div class="school-banner">
        <h1 id="t_school">DAMOT 01 SECONDARY SCHOOL</h1>
        <p id="t_slogan">Quality Education for a Better Future</p>
    </div>

    <div id="loginSection" class="login-card">
        <h2 id="t_welcome">·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°!</h2>
        <input type="text" id="regName" placeholder="Full Name">
        <input type="text" id="regID" placeholder="ID Number">
        <input type="password" id="regPass" placeholder="Password">
        <br>
        <button class="btn-main" id="t_viewBtn" onclick="loadStudentResult()">View My Result</button>
    </div>

    <div id="adminLoginSection" class="admin-card" style="display:none;">
        <h2>Admin Operator Access</h2>
        <input type="password" id="adminKey" placeholder="Enter Admin Secret Key">
        <br>
        <button class="btn-main" onclick="accessAdmin()">Access Admin Area</button>
    </div>

    <div id="adminArea">
        <div style="background: #fff5f5; padding: 30px; border-radius: 20px; margin-bottom: 30px; border: 1px solid #ffcccc;">
            <h3 style="color: var(--danger); margin-top:0;">Delete Single Student</h3>
            <p>Enter Student ID to remove from database:</p>
            <input type="text" id="deleteID" placeholder="Student ID (e.g. 156001)">
            <br>
            <button class="btn-danger" onclick="deleteStudent()">Delete This Student</button>
        </div>

        <hr>
        <h3>Bulk Upload Students (JSON)</h3>
        <p>write your students JSON here:</p>
        <textarea id="bulkData" rows="10" style="width:100%;" placeholder='{"1001": {"name": "Test", "maths": 90...}}'></textarea>
        <br>
        <button class="btn-main" onclick="uploadData()">Upload to Firebase</button>
        <button class="btn-main" style="background:#666;" onclick="location.reload()">Back</button>
    </div>

    <div id="resultArea">
        <img id="pPhoto" src="" style="width:160px; height:160px; border-radius:50%; display:block; margin:0 auto 20px; border:8px solid #fff; box-shadow:0 10px 20px rgba(0,0,0,0.1);">
        <div id="pName"></div>
        <div class="report-label" id="pIDLabel">OFFICIAL STUDENT TRANSCRIPT</div>

        <div class="grid-info">
            <div class="info-cell"><label id="l_id">ID No</label><div id="pID"></div></div>
            <div class="info-cell"><label id="l_gen">Gender</label><div id="pGen"></div></div>
            <div class="info-cell"><label id="l_grade">Grade</label><div id="pGrade"></div></div>
            <div class="info-cell"><label id="l_year">Year</label><div id="pYear"></div></div>
            <div class="info-cell"><label id="l_nat">Nationality</label><div id="pNat"></div></div>
            <div class="info-cell"><label id="l_zone">Zone</label><div id="pZone"></div></div>
            <div class="info-cell"><label id="l_wor">Woreda</label><div id="pWor"></div></div>
            <div class="info-cell"><label id="l_sch">School</label><div id="pSch"></div></div>
        </div>

        <div class="summary-ribbon">
            <div class="ribbon-item"><span id="l_total">Total Score</span><b id="pTotal"></b></div>
            <div class="ribbon-item"><span id="l_avg">Average</span><b id="pAvg"></b></div>
            <div class="ribbon-item"><span id="l_status">Status</span><b id="pStatus"></b></div>
        </div>

        <table>
            <thead>
                <tr><th id="h_sub">Subject</th><th>40%</th><th>60%</th><th id="h_tot">Total</th><th id="h_grd">Grade</th></tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <div class="action-bar no-pdf">
            <button class="btn-pdf" id="t_download" onclick="downloadPDF()">Download PDF Report</button>
            <a href="tel:0961364574" class="btn-call">üìû <span id="t_call">Support</span></a>
        </div>
    </div>
    
    <div class="admin-link no-pdf" onclick="showAdminLogin()">Admin Operator</div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    const translations = {
        am: { school: "·ã≥·àû·âµ 01 ·àÅ·àà·â∞·äõ ·ã∞·à®·åÉ ·âµ·àù·àÖ·à≠·âµ ·â§·âµ", slogan: "·å•·à´·âµ ·ã´·àà·ãç ·âµ·àù·àÖ·à≠·âµ ·àà·â∞·àª·àà ·àÖ·ã≠·ãà·âµ ", welcome: "·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°!", viewBtn: "·ãç·å§·âµ ·ã≠·àò·àç·ä®·â±", l_id: "·àò·àà·ã´ ·âÅ·å•·à≠", l_gen: "·åæ·â≥", l_grade: "·ä≠·çç·àç", l_year: "·ãò·àò·äï", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·äï", l_wor: "·ãà·à®·ã≥", l_sch: "·âµ·àù·àÖ·à≠·âµ ·â§·âµ", l_total: "·ãµ·àù·à≠", l_avg: "·ä†·àõ·ä´·ã≠", l_status: "·àÅ·äî·â≥", h_sub: "·âµ·àù·àÖ·à≠·âµ", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä†·ãç·à≠·ãµ", call: "·âÖ·à¨·â≥", report: "·ä¶·çä·à¥·àã·ãä ·ã®·ãç·å§·âµ ·àò·åç·àà·å´", sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "·ä†·ã≠·à≤·â≤", "·ä§·âΩ·çí", "·ä†·àõ·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] },
        en: { school: "DAMOT 01 SECONDARY SCHOOL", slogan: "Quality Education", welcome: "Welcome!", viewBtn: "View Result", l_id: "ID", l_gen: "Gender", l_grade: "Grade", l_year: "Year", l_nat: "Nationality", l_zone: "Zone", l_wor: "Woreda", l_sch: "School", l_total: "Total", l_avg: "Avg", l_status: "Status", h_sub: "Subject", h_tot: "Total", h_grd: "Grade", download: "Download PDF", call: "Support", report: "OFFICIAL TRANSCRIPT", sNames: ["Maths", "English", "Chemistry", "Physics", "Biology", "Geography", "History", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        om: { school: "MANA BARUMSA DAMOT 01", slogan: "Barnoota Qulqulluu", welcome: "Baga Nagaan Dhuftan!", viewBtn: "Bu'aa Ilaali", l_id: "ID", l_gen: "Korniyaa", l_grade: "Kutaa", l_year: "Bara", l_nat: "Lammummaa", l_zone: "Zoonii", l_wor: "Aanaa", l_sch: "Mana Barumsaa", l_total: "Ida'ama", l_avg: "Avg", l_status: "Haala", h_sub: "Barnoota", h_tot: "Total", h_grd: "Gireedii", download: "PDF Buusi", call: "Koomii", report: "GABAASA BU'AA", sNames: ["Maatiiksii", "Ingiliffa", "Keemistirii", "Fiiziksii", "Baayoloojii", "Ji'oogiraafii", "Seenaa", "ICT", "HP", "Amharic", "Citizenship", "Economics"] },
        so: { school: "DUGSIYADA DAMOT 01", slogan: "Waxbarasho tayo leh", welcome: "Ku soo dhawaada!", viewBtn: "Arag Natiijada", l_id: "ID", l_gen: "Lab/Dhadig", l_grade: "Fasalka", l_year: "Sannadka", l_nat: "Dhalashada", l_zone: "Aagga", l_wor: "Degmada", l_sch: "Dugsiga", l_total: "Warta", l_avg: "Avg", l_status: "Xaaladda", h_sub: "Maadada", h_tot: "Total", h_grd: "Darajada", download: "PDF", call: "Cabashada", report: "NATIIJADA", sNames: ["Xisaab", "Ingiriisi", "Kimisteri", "Fiisigis", "Bayoolaji", "Juqraafi", "Taariikh", "ICT", "HP", "Amxaari", "Muwaadin", "Dhaqaalaha"] },
        ti: { school: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤ ·â§·âµ ·ã≥·àû·âµ 01", slogan: "·çÖ·à¨·âµ ·ãò·àà·ãé ·âµ·àù·àÖ·à≠·â≤", welcome: "·ä•·äï·ä≥·ãï ·â•·ã∞·àì·äï ·àò·åª·ä•·ä©·àù!", viewBtn: "·ãç·åΩ·ä¢·âµ ·à≠·ä†", l_id: "·àò·çç·àà·ã™", l_gen: "·çÜ·â≥", l_grade: "·ä≠·çç·àä", l_year: "·ãì·àò·âµ", l_nat: "·ãú·åç·äê·âµ", l_zone: "·ãû·â£", l_wor: "·ãà·à®·ã≥", l_sch: "·â§·âµ ·âµ·àù·àÖ·à≠·â≤", l_total: "·å†·âï·àã·àã", l_avg: "Avg", l_status: "·ä©·äê·â≥·âµ", h_sub: "·âµ·àù·àÖ·à≠·â≤", h_tot: "·ãµ·àù·à≠", h_grd: "·ã∞·à®·åÉ", download: "PDF ·ä£·ãç·à≠·ãµ", call: "·âÖ·à¨·â≥", report: "·àò·åç·àà·çÇ ·ãç·çÖ·ä¢·âµ", sNames: ["·àí·à≥·â•", "·ä•·äï·åç·àä·ãù·äõ", "·ä¨·àö·àµ·âµ·à™", "·çä·ãö·ä≠·àµ", "·â£·ãÆ·àé·åÇ", "·åÇ·ä¶·åç·à´·çä", "·â≥·à™·ä≠", "ICT", "HP", "·ä£·àù·àì·à≠·äõ", "·ãú·åç·äê·âµ", "·ä¢·äÆ·äñ·àö·ä≠·àµ"] }
    };

    let activeLang = 'am';
    let studentData = null;

    const firebaseConfig = {
      apiKey: "AIzaSyDqX185jJuZU5SGEjVVNCGNh5aS0hgov58",
      databaseURL: "https://damoto-school-result-default-rtdb.firebaseio.com",
      projectId: "damoto-school-result"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function setLanguage(lang, btn) {
        activeLang = lang;
        const t = translations[lang];
        document.getElementById('t_school').innerText = t.school;
        document.getElementById('t_slogan').innerText = t.slogan;
        document.getElementById('t_welcome').innerText = t.welcome;
        document.getElementById('t_viewBtn').innerText = t.viewBtn;
        document.getElementById('l_id').innerText = t.l_id;
        document.getElementById('l_gen').innerText = t.l_gen;
        document.getElementById('l_grade').innerText = t.l_grade;
        document.getElementById('l_year').innerText = t.l_year;
        document.getElementById('l_nat').innerText = t.l_nat;
        document.getElementById('l_zone').innerText = t.l_zone;
        document.getElementById('l_wor').innerText = t.l_wor;
        document.getElementById('l_sch').innerText = t.l_sch;
        document.getElementById('l_total').innerText = t.l_total;
        document.getElementById('l_avg').innerText = t.l_avg;
        document.getElementById('l_status').innerText = t.l_status;
        document.getElementById('h_sub').innerText = t.h_sub;
        document.getElementById('h_tot').innerText = t.h_tot;
        document.getElementById('h_grd').innerText = t.h_grd;
        document.getElementById('t_download').innerText = t.download;
        document.getElementById('t_call').innerText = t.call;
        document.getElementById('pIDLabel').innerText = t.report;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        if(studentData) renderTable();
    }

    function loadStudentResult() {
        const nameIn = document.getElementById('regName').value.trim();
        const idIn = document.getElementById('regID').value.trim();
        const passIn = document.getElementById('regPass').value.trim();
        db.ref('students/' + idIn).once('value').then(snap => {
            const d = snap.val();
            if(d && d.password == passIn && d.name.toLowerCase() === nameIn.toLowerCase()) {
                studentData = d;
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('resultArea').style.display = 'block';
                document.getElementById('pPhoto').src = d.photoURL || "https://via.placeholder.com/180";
                document.getElementById('pName').innerText = d.name;
                document.getElementById('pID').innerText = idIn;
                document.getElementById('pGen').innerText = d.gender;
                document.getElementById('pGrade').innerText = d.grade;
                document.getElementById('pYear').innerText = d.academicYear || "2018 E.C";
                document.getElementById('pNat').innerText = d.nationality || "Ethiopian";
                document.getElementById('pZone').innerText = d.zone || "East Gojjam";
                document.getElementById('pWor').innerText = d.woreda || "Hulet Eju Enese";
                document.getElementById('pSch').innerText = "Damot 01 Secondary School";
                document.getElementById('pTotal').innerText = d.total;
                document.getElementById('pAvg').innerText = d.average + "%";
                document.getElementById('pStatus').innerText = d.status;
                renderTable();
            } else { alert("Correct Credentials Required!"); }
        });
    }

    function renderTable() {
        const d = studentData;
        const sNames = translations[activeLang].sNames;
        const subList = [
            {n: sNames[0], t: d.maths, s4: d.maths40, s6: d.maths60}, {n: sNames[1], t: d.english, s4: d.english40, s6: d.english60},
            {n: sNames[2], t: d.chemistry, s4: d.chemistry40, s6: d.chemistry60}, {n: sNames[3], t: d.physics, s4: d.physics40, s6: d.physics60},
            {n: sNames[4], t: d.biology, s4: d.biology40, s6: d.biology60}, {n: sNames[5], t: d.geography, s4: d.geography40, s6: d.geography60},
            {n: sNames[6], t: d.history, s4: d.history40, s6: d.history60}, {n: sNames[7], t: d.ict, s4: d.ict40, s6: d.ict60},
            {n: sNames[8], t: d.hp, s4: d.hp40, s6: d.hp60}, {n: sNames[9], t: d.amharic, s4: d.amharic40, s6: d.amharic60},
            {n: sNames[10], t: d.citizenship, s4: d.citizenship40, s6: d.citizenship60}, {n: sNames[11], t: d.economics, s4: d.economics40, s6: d.economics60}
        ];
        let h = "";
        subList.forEach(s => {
            let g = s.t >= 90 ? "A+" : s.t >= 80 ? "A" : s.t >= 70 ? "B" : s.t >= 50 ? "C" : "D";
            h += `<tr><td style="text-align:left;">${s.n}</td><td>${s.s4||0}</td><td>${s.s6||0}</td><td><b>${s.t||0}</b></td><td><b>${g}</b></td></tr>`;
        });
        document.getElementById('tableBody').innerHTML = h;
    }

    function downloadPDF() {
        const element = document.getElementById('printableArea');
        const opt = {
            margin: 0, filename: 'Damot01_Result.pdf', image: { type: 'jpeg', quality: 1 },
            html2canvas: { scale: 2, useCORS: true },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
        };
        document.querySelectorAll('.no-pdf').forEach(el => el.style.visibility = 'hidden');
        html2pdf().from(element).set(opt).save().then(() => {
            document.querySelectorAll('.no-pdf').forEach(el => el.style.visibility = 'visible');
        });
    }

    function showAdminLogin() {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('adminLoginSection').style.display = 'block';
    }

    function accessAdmin() {
        if(document.getElementById('adminKey').value === "damot1q2w3e4@") {
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('adminArea').style.display = 'block';
        } else { alert("Access Denied!"); }
    }

    function uploadData() {
        try {
            const data = JSON.parse(document.getElementById('bulkData').value);
            db.ref('students').update(data).then(() => alert("Students uploaded successfully!"));
        } catch(e) { alert("Invalid JSON format!"); }
    }

    function deleteStudent() {
        const id = document.getElementById('deleteID').value.trim();
        if(!id) { alert("Please enter Student ID!"); return; }
        if(confirm("Are you sure you want to delete ID: " + id + "?")) {
            db.ref('students/' + id).remove().then(() => {
                alert("Student deleted successfully!");
                document.getElementById('deleteID').value = "";
            });
        }
    }
</script>
</body>
</html>